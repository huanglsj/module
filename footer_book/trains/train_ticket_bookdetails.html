<!DOCTYPE html>
<html class="um landscape min-width-240px min-width-320px min-width-480px min-width-768px min-width-1024px">

	<head>
		<title></title>
		<meta charset="utf-8">
		<meta name="viewport" content="target-densitydpi=device-dpi, width=device-width, initial-scale=1, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link rel="stylesheet" href="../../css/fonts/font-awesome.min.css">
		<link rel="stylesheet" href="../../css/ui-box.css">
		<link rel="stylesheet" href="../../css/ui-base.css">
		<link rel="stylesheet" href="../../css/ui-color.css">
		<link rel="stylesheet" href="../../css/appcan.icon.css">
		<link rel="stylesheet" href="../../css/appcan.control.css">
		<link rel="stylesheet" type="text/css" href="../../css/main.css" />
		<link rel="stylesheet" type="text/css" href="css/train-ticket.css" />

	</head>

	<body class="um-vp" ontouchstart>
		<div class="up ub ub-ver " tabindex="0">
			<!--header开始-->
			<div id="header" class="uh bc-text-head ub header-bg">
				<div class="nav-btn back" id="nav-left">
					<div class="ub-img user-icon-goback umw1-5 umh4"></div>
				</div>
				<div class="ub ub-ac ub-pc ub-f1 ulev-3 ut-s tx-c" tabindex="0">
					<div id="fromSta">广州</div>
					<div class="toPic"></div>
					<div id="toSta">上海</div>
				</div>
				<div class="nav-btn nav-bt icon-act" id="nav-right">
					<div class="btn  user-icon-phone ub-img user-umar-r1"></div>
				</div>
			</div>
			<!--header结束-->
			<!--content开始-->
			<div id="content" class="ub-f1 tx-l"></div>
			<!--content结束-->
			<div id="footer" class="footer-ub">
				<div class="ub ub-ac train-d-footer">
					<div class="ub ub-f1 ub-ac train-d-info">
						<div class="ub big">总额：<span class="money" id="train_ticket_price"></span></div>
						<input id="personNum" type="hidden" value="0" />
						<div class="ub ub-pe ub-f1" id="showDetail">明细 <i class="fa fa-angle-down"></i></div>
					</div>
					<div class="train-d-btn ub ub-f1 ub-ac ub-pc" id="divid_submitOd">提交订单</div>
				</div>
			</div>
		</div>
	</body>

	<script src="../../js/appcan.js"></script>
	<script src="../../js/appcan.control.js"></script>
	<script src="../../js/common.js"></script>
	<script>
		appcan.ready(function() {
			var titHeight = $('#header').offset().height;
			appcan.frame.open("content", "train_ticket_bookdetails_content.html", 0, titHeight);
			window.onorientationchange = window.onresize = function() {
				appcan.frame.resize("content", 0, titHeight);
			}
			$("#fromSta").html(appcan.locStorage.getVal("from_station_city"));
			$("#toSta").html(appcan.locStorage.getVal("to_station_city"));
			seatItem = appcan.locStorage.getVal("seatItem");
			seatItem = eval('(' + seatItem + ')');
			if(seatItem) {
				$("#train_ticket_price").html(seatItem.price);
			}
			appcan.button("#nav-left", "btn-act", function() {
				appcan.window.confirm({
					title: '确认',
					content: '是否确认取消订票',
					buttons: ['确认', '取消'],
					callback: function(err, data, dataType, optId) {
						console.log(data);
						if(data == 0) {
							appcan.window.evaluatePopoverScript({
								name: 'train_ticket_bookdetails',
								popName: 'content',
								scriptContent: 'cancelBook();',
							});
							var pages = ["login_12306", "train_ticket_booked", "train_ticket_searchresult"];
							for(var i = 0; i < pages.length; i++) {
								appcan.window.evaluateScript({
									name: pages[i],
									scriptContent: "appcan.window.close(-1)"
								});
							}
							setTimeout('appcan.window.close(-1)', 500);
						}
					}
				})
			})

			appcan.button("#nav-right", "btn-act", function() {
				uexCall.dial("12306");
			});
			appcan.button("#divid_submitOd", "btn-act", function() {
				appcan.window.evaluatePopoverScript("train_ticket_bookdetails", "content", "checkSubmit(submitOrder)");
			});

			appcan.button("#showDetail", "btn-act", function() {
				appcan.window.evaluatePopoverScript({
					name: 'train_ticket_bookdetails',
					popName: 'content',
					scriptContent: "showOtherDetail()"
				});
			})

		});

		function totalPrice(price, len) {
			$("#train_ticket_price").html('￥' + price);
			$("#personNum").val(len);
		}
	</script>

</html>